/* Virtual Keyboard Styles
 * CSS Custom Properties for easy theming
 * No !important - Shadow DOM provides encapsulation
 */

/* =============================================================================
   CSS Custom Properties (Theme Variables)
   ============================================================================= */

:host {
  /* Colors */
  --vk-bg: linear-gradient(to top, #000, #333);
  --vk-key-bg: #525152;
  --vk-key-active-bg: #ddd;
  --vk-key-active-color: #333;
  --vk-key-color: #fff;
  --vk-action-key-bg: #212021;
  --vk-space-key-bg: #212421;
  --vk-shift-active-bg: #ddd;
  --vk-shift-active-color: #333;

  /* Overlay colors */
  --vk-overlay-bg: linear-gradient(to top, #000, #333);
  --vk-overlay-btn-bg: rgba(255, 255, 255, 0.05);
  --vk-overlay-btn-hover-bg: rgba(255, 255, 255, 0.3);

  /* URL bar colors */
  --vk-url-bar-bg: rgba(255, 255, 255, 0.8);

  /* Sizing */
  --vk-height: 450px;
  --vk-padding: 15px;
  --vk-key-padding: 30px;
  --vk-key-radius: 6px;
  --vk-key-font-size: 32px;
  --vk-action-font-size: 22px;

  /* Animation */
  --vk-transition-duration: 0.4s;
  --vk-transition-timing: ease;

  /* Z-index */
  --vk-z-index: 10000000;
  --vk-overlay-z-index: 10000001;
}

/* =============================================================================
   Keyboard Container
   ============================================================================= */

#virtual-keyboard {
  --vk-offset-x: 0px;
  position: fixed;
  bottom: 0;
  left: 50%;
  transform: translateX(calc(-50% + var(--vk-offset-x)))
    translate3d(0, var(--vk-height), 0);
  opacity: 0;
  padding: var(--vk-padding);
  background: var(--vk-bg);
  box-shadow: inset 0 1px 1px rgba(255, 255, 255, 0.2);
  z-index: var(--vk-z-index);
  user-select: none;
  transition:
    transform var(--vk-transition-duration) var(--vk-transition-timing),
    opacity var(--vk-transition-duration) var(--vk-transition-timing);
  font-family: "Segoe UI", Tahoma, sans-serif;
}

#virtual-keyboard.keyboard-open {
  transform: translateX(calc(-50% + var(--vk-offset-x))) translate3d(0, 0, 0);
  opacity: 1;
}

#virtual-keyboard.keyboard-closed {
  transform: translateX(calc(-50% + var(--vk-offset-x)))
    translate3d(0, var(--vk-height), 0);
  opacity: 0;
}

/* =============================================================================
   Keyboard Rows
   ============================================================================= */

.vk-row {
  display: flex;
  justify-content: center;
  gap: 6px;
  margin: 5px 0;
}

/* =============================================================================
   Keys - Base Styles
   ============================================================================= */

.vk-key {
  position: relative;
  padding: var(--vk-key-padding) 20px;
  margin: 0;
  border: none;
  border-radius: var(--vk-key-radius);
  background: var(--vk-key-bg);
  color: var(--vk-key-color);
  font-family: inherit;
  font-size: var(--vk-key-font-size);
  text-align: center;
  cursor: pointer;
  box-shadow:
    inset 0 1px 0 rgba(255, 255, 255, 0.4),
    inset 0 -1px 1px rgba(0, 0, 0, 1);
  transition:
    background 0.15s,
    color 0.15s,
    transform 0.1s;
  text-shadow: 0 0 10px rgba(0, 0, 0, 0.4);
  flex: 1;
  min-width: 0;
}

.vk-key:active,
.vk-key.active {
  background: var(--vk-key-active-bg);
  color: var(--vk-key-active-color);
}

.vk-key span {
  display: block;
  line-height: 1;
}

/* =============================================================================
   Special Key Types
   ============================================================================= */

/* Action keys (Close, &123, Settings) */
.vk-key-action {
  background: var(--vk-action-key-bg);
  font-size: var(--vk-action-font-size);
}

/* Space key */
.vk-key-space {
  flex: 3;
  background: var(--vk-space-key-bg);
}

/* Shift key */
.vk-key-shift {
  background: var(--vk-action-key-bg);
  flex: 1.2;
}

.shift-active .vk-key-shift {
  background: var(--vk-shift-active-bg);
  color: var(--vk-shift-active-color);
}

/* Backspace key */
.vk-key-backspace {
  background: var(--vk-key-bg);
  flex: 1.5;
}

.vk-key-backspace-sm {
  background: var(--vk-key-bg);
  flex: 1;
}

/* Enter key */
.vk-key-enter {
  background: var(--vk-key-bg);
  flex: 1.5;
}

/* Spacer (empty cell) */
.vk-spacer {
  width: 1px;
  visibility: hidden;
  padding: 0;
  margin: 0;
  flex: 0 0 1px;
}

/* Language button (menu button, not a clickable key) */
.vk-lang-btn {
  position: relative;
  padding: var(--vk-key-padding) 20px;
  margin: 0;
  border: none;
  border-radius: var(--vk-key-radius);
  background: var(--vk-action-key-bg);
  color: var(--vk-key-color);
  font-family: inherit;
  font-size: var(--vk-action-font-size);
  text-align: center;
  cursor: pointer;
  box-shadow:
    inset 0 1px 0 rgba(255, 255, 255, 0.4),
    inset 0 -1px 1px rgba(0, 0, 0, 1);
  transition:
    background 0.15s,
    color 0.15s,
    transform 0.1s;
  text-shadow: 0 0 10px rgba(0, 0, 0, 0.4);
  flex: 1;
  min-width: 0;
}

.vk-lang-btn:active {
  background: var(--vk-key-active-bg);
  color: var(--vk-key-active-color);
}

.vk-lang-btn span {
  display: block;
  line-height: 1;
}

/* URL button text adjustment */
#vk-url-btn span {
  margin-left: -10px;
}

/* =============================================================================
   Icons (Unicode characters)
   ============================================================================= */

.vk-icon {
  display: block;
  font-size: 24px;
  line-height: 1;
}

.vk-icon-shift::before {
  content: "⇧";
}

.vk-icon-backspace::before {
  content: "⌫";
}

.vk-icon-enter::before {
  content: "↵";
}

.vk-icon-close::before {
  content: "✕";
}

.vk-icon-settings::before {
  content: "⚙";
}

/* =============================================================================
   Shift Mode - Uppercase Display
   ============================================================================= */

.shift-active .vk-key-case {
  text-transform: uppercase;
}

/* Keys with explicit shift display (Korean, etc.) */
.vk-key-case span {
  /* Content updated via JavaScript */
}

/* =============================================================================
   Email Input Keys
   Note: Visibility is controlled by JavaScript (setEmailKeysVisibility)
   These are just initial states before JS runs
   ============================================================================= */

.vk-email-key {
  display: none;
}

.vk-hide-email-key {
  display: inline-flex;
}

/* =============================================================================
   Number Bar
   ============================================================================= */

#vk-number-bar {
  display: flex;
  gap: 6px;
  margin-bottom: 5px;
}

#vk-number-bar .vk-key {
  padding: 30px 20px;
}

/* Hide number bar on small screens */
@media (max-height: 600px) {
  #vk-number-bar {
    display: none;
  }
}

/* =============================================================================
   Number Input Keyboard (for number/tel inputs)
   ============================================================================= */

#vk-number-bar-input {
  max-width: 400px;
  margin: 0 auto;
}

/* =============================================================================
   Numbers/Symbols Keyboard
   ============================================================================= */

#vk-main-numbers .vk-key {
  padding: 30px;
}

/* =============================================================================
   Overlays (Settings menu, accent menus)
   ============================================================================= */

.vk-overlay {
  position: fixed;
  z-index: var(--vk-overlay-z-index);
  padding: 5px;
  border-radius: 5px;
  background: var(--vk-overlay-bg);
  box-shadow: 0 0 10px #000;
  transition:
    opacity 0.4s,
    margin 0.2s;
}

.vk-overlay[data-state="closed"] {
  opacity: 0;
  margin-bottom: -5px;
  pointer-events: none;
}

.vk-overlay[data-state="open"] {
  opacity: 1;
  margin-bottom: 0;
}

.vk-overlay-keys {
  display: flex;
  list-style: none;
  margin: 0;
  padding: 0;
  gap: 6px;
}

.vk-overlay-btn {
  padding: 20px;
  border-radius: 5px;
  background: var(--vk-overlay-btn-bg);
  color: #fff;
  font-size: 14px;
  font-weight: bold;
  text-shadow: 0 0 3px #000;
  cursor: pointer;
  transition: background 0.2s;
}

.vk-overlay-btn:hover,
.vk-overlay-btn[data-mouse-over="true"] {
  background: var(--vk-overlay-btn-hover-bg);
}

/* =============================================================================
   URL Bar
   ============================================================================= */

#vk-url-bar {
  position: fixed;
  top: -100px;
  left: 50%;
  transform: translateX(-50%);
  width: 600px;
  padding: 5px;
  background: var(--vk-url-bar-bg);
  border-radius: 0 0 3px 3px;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
  z-index: 999999;
  transition: top 0.3s;
}

#vk-url-bar[data-open="true"] {
  top: -70px;
}

#vk-url-bar-textbox {
  width: calc(100% - 20px);
  padding: 5px;
  font-size: 30px;
  border: 1px solid #ccc;
  border-radius: 3px;
}

#vk-url-bar input[type="submit"] {
  display: none;
}

/* =============================================================================
   Scroll Extend Element
   ============================================================================= */

#vk-scroll-extend {
  height: 500px;
}

/* =============================================================================
   Drag Handle for Repositioning
   ============================================================================= */

.vk-drag-handle {
  position: absolute;
  top: -25px;
  left: 50%;
  transform: translateX(-50%);
  padding: 4px 20px;
  background: rgba(255, 255, 255, 0.15);
  border-radius: 10px 10px 0 0;
  color: rgba(255, 255, 255, 0.6);
  font-size: 14px;
  letter-spacing: 2px;
  cursor: grab;
  user-select: none;
  touch-action: none;
  transition:
    background 0.2s,
    color 0.2s;
}

.vk-drag-handle:hover {
  background: rgba(255, 255, 255, 0.25);
  color: rgba(255, 255, 255, 0.9);
}

.vk-drag-handle:active,
#virtual-keyboard.vk-dragging .vk-drag-handle {
  cursor: grabbing;
  background: rgba(255, 255, 255, 0.3);
}

#virtual-keyboard.vk-dragging {
  transition: none;
}

/* =============================================================================
   Responsive Zoom (based on viewport height)
   ============================================================================= */

@media (max-height: 950px) {
  #virtual-keyboard {
    zoom: 0.95;
  }
}

@media (max-height: 900px) {
  #virtual-keyboard {
    zoom: 0.9;
  }
}

@media (max-height: 850px) {
  #virtual-keyboard {
    zoom: 0.85;
  }
}

@media (max-height: 800px) {
  #virtual-keyboard {
    zoom: 0.8;
  }
}

@media (max-height: 750px) {
  #virtual-keyboard {
    zoom: 0.75;
  }
}

@media (max-height: 700px) {
  #virtual-keyboard {
    zoom: 0.7;
  }
}

@media (max-height: 650px) {
  #virtual-keyboard {
    zoom: 0.65;
  }
}

@media (max-height: 550px) {
  #virtual-keyboard {
    zoom: 0.6;
  }
}

@media (max-height: 500px) {
  #virtual-keyboard {
    zoom: 0.55;
  }
}

@media (max-height: 450px) {
  #virtual-keyboard {
    zoom: 0.5;
  }
}

@media (max-height: 400px) {
  #virtual-keyboard {
    zoom: 0.45;
  }
}

@media (max-height: 350px) {
  #virtual-keyboard {
    zoom: 0.4;
  }
}

@media (max-height: 300px) {
  #virtual-keyboard {
    zoom: 0.35;
  }
}

/* =============================================================================
   Touch-friendly Form Elements (for options page)
   ============================================================================= */

.touchEnable input[type="checkbox"],
.touchEnable input[type="radio"] {
  appearance: none;
  width: 26px;
  height: 26px;
  border: 1px solid #a0a0a0;
  border-radius: 3px;
  background: linear-gradient(#fafafa, gainsboro);
  box-shadow:
    inset 0 1px 2px white,
    0 1px 2px rgba(0, 0, 0, 0.2);
  vertical-align: middle;
  cursor: pointer;
}

.touchEnable input[type="radio"] {
  border-radius: 50%;
}

.touchEnable input[type="checkbox"]:checked::before {
  content: "✓";
  display: block;
  text-align: center;
  font-size: 18px;
  color: gray;
  line-height: 24px;
}

.touchEnable input[type="radio"]:checked::before {
  content: "";
  display: block;
  width: 14px;
  height: 14px;
  margin: 5px;
  background: gray;
  border-radius: 50%;
}

.touchEnable button {
  padding: 15px 40px;
  border: 1px solid #a0a0a0;
  border-radius: 3px;
  background: linear-gradient(#fafafa, gainsboro);
  box-shadow:
    inset 0 1px 2px white,
    0 1px 2px rgba(0, 0, 0, 0.2);
  font-size: 13px;
  cursor: pointer;
  user-select: none;
}

.touchEnable input[type="text"],
.touchEnable input[type="search"],
.touchEnable input[type="password"],
.touchEnable textarea {
  padding: 7px;
  border: 1px solid #a0a0a0;
  border-radius: 3px;
  font-size: 20px;
  box-shadow:
    inset 0 2px 2px rgba(0, 0, 0, 0.1),
    0 1px 0 white;
}
